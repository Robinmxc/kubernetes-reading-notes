- hosts:
  - localhost
  tags: always
  any_errors_fatal: true
  roles:
  - ruijie/smpplus/env

- hosts:
  - mongodb
  tags:
  - mongodb
  - midware
  any_errors_fatal: true
  roles:
  - { role: ruijie/mongo}

- hosts:
  - rocketmq
  tags:
  - rocketmq
  - midware
  any_errors_fatal: true
  roles:
  - { role: ruijie/rocketmq}

- hosts:
  - kube_node
  gather_facts: true
  tags:
  - initdata
  any_errors_fatal: true
  vars_files:
  - "{{ KAD_PACKAGE_DIR }}/kad.yml"
  roles:
  - { role: ruijie/smpplus/prepare-db-pwd, tags: always }
  - { role: ruijie/smpplus/dbinit }
- hosts:
  - kube_node
  tags:
  - smpplus
  any_errors_fatal: true
  vars_files:
  - "{{ KAD_PACKAGE_DIR }}/kad.yml"
  roles:
  - { role: ruijie/smpplus/component, tags: ["component"] }
  - { role: ruijie/smpplus/linkid, tags: ["linkid"] }
  - { role: ruijie/smpplus/authentication, tags: ["authentication"] }
  - { role: ruijie/smpplus/aggregation, tags: ["aggregation"] }
  - { role: ruijie/smpplus/eportal, tags: ["eportal"] }
  - { role: ruijie/smpplus/frontend-smp, tags: ["frontend-smp"] }
  - { role: ruijie/smpplus/frontend-portal, tags: ["frontend-portal"] }
  - { role: ruijie/smpplus/freeradius, tags: ["freeradius"] }
  - { role: ruijie/smpplus/license, tags: ["license"] }
  - { role: ruijie/smpplus/adminui, tags: ["adminui"] }
  - { role: ruijie/smpplus/nodemanager-scan, tags: ["nodemanager-scan"] }
  - { role: ruijie/smpplus/sms-middleware, tags: ["sms-middleware"] }