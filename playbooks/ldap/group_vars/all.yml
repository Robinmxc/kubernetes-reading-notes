LDAP_ENABLE: "{% if LDAP is defined and LDAP['enable'] %}yes{% else %}no{% endif %}"

bin_dir: "/opt/kube/bin"

max_space_dir: "{{
    hostvars[groups['ldap'][0]].ansible_mounts
    | selectattr('mount', 'match', '^(?!/var/lib/).*')
    | sort('size_available' | int)
    | map(attribute='mount')
    | list
    | last }}"

DATA_DIR: "{% if '/' == max_space_dir %}{% else %}{{ max_space_dir }}{% endif %}"

namespace_dir: "{{ base_dir }}/workspace/{{ APP_NAMESPACE }}"

yaml_dir: "{{ namespace_dir }}/yaml"

LDAP_DOWN_PATH: "/opt/kad/down/ldap"

DEST_FILE_PATH: "{{ DATA_DIR }}/file"

ldap_deploy_mode: "{{ groups['ldap'] | length }}"

ldap_dual_mode_port: 388

#将ldap改成388端口
ldap_port_conf: "{% if ldap_deploy_mode  == '2' %}ldapi:/// ldap://0.0.0.0:{{ ldap_dual_mode_port }}/ ldaps:///{% else %}ldapi:/// ldap://0.0.0.0:{{ LDAP.LDAP_PORT }}/ ldaps://0.0.0.0:{{ LDAP.LDAP_SSL_PORT }}/{% endif %}"

#nginx安装目录
NGINX_SRC_PATH: "/usr/local/src"

ldap_file: "ldap.tar.gz"
nginx_file: "nginx-1.20.1.tar.gz"
keepalived_file: "keepalived.tar.gz"

LDAP_READONLY_USER_USERNAME: "readonly"
