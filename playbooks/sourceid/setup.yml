- hosts:
  - localhost
  tags: always
  roles:
  - ruijie/sourceid/k8s-config

- hosts:
  - mongodb
  tags:
  - mongodb
  - midware
  roles:
  - { role: ruijie/mongo}

- hosts:
  - rocketmq
  tags:
  - rocketmq
  - midware
  roles:
  - { role: ruijie/rocketmq}

- hosts:
  - kube-node
  tags:
  - initdata
  vars_files:
  - "{{ workspace_dir }}/kad.yml"
  roles:
  - { role: ruijie/sourceid/prepare-db-pwd, tags: always }
  - { role: ruijie/sourceid/dbinit }

- hosts:
  - kube-node
  tags:
  - sourceid
  vars_files:
  - "{{ workspace_dir }}/kad.yml"
  roles:
  - { role: ruijie/sourceid/prepare-db-pwd, tags: always }
  - { role: ruijie/sourceid/linkid, tags: ["linkid"]}
  - { role: ruijie/sourceid/sso, tags: ["sso"] }
  - { role: ruijie/sourceid/gate, tags: ["gate"] }
  - { role: ruijie/sourceid/component, tags: ["component"] }
  - { role: ruijie/sourceid/frontend, tags: ["frontend"] }
