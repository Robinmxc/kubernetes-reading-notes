- name: 确保unzip已安装
  yum:
    name:
      - unzip
    state: present

- name: 读取目录信息
  stat: path="{{ sourceid_kad_dir }}"
  register: p

- name: 创建解压目录
  file: path="{{ sourceid_kad_dir }}" state=directory
  when: 'not p.stat.exists'

- name: 解压SourceID部署包
  vars:
    zip_file: "{{ img_download_dir }}/sourceid-kad-{{ SOURCEID_KAD_VERSION }}.zip"
  unarchive:
    src: "{{ zip_file }}"
    dest: "{{ sourceid_kad_dir }}"
  when: 'not p.stat.exists and zip_file is exists'
