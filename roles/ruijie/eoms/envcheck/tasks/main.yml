- name: 检查运维平台配置参数
  fail: msg="安装运维平台需要先设置EOMS参数"
  when: 'EOMS_ENABLE == "no"'

- name: 更新加载所需基础rpm包
  when: 'EOMS_ENABLE == "no"'
  block:
    - name: 准备目录
      file: name={{ item }} state=directory
      with_items:
        - "{{ DEST_FILE_PATH }}/rpm"

    - name: 复制安装文件
      copy:
        src: "{{ EOMS_DOWN_PATH }}/rpm/"
        dest: "{{ DEST_FILE_PATH }}/rpm/"

    - name: 安装文件
      vars:
        rpm_file_name: "{{ item }}"
      shell: "yum install -y {{ DEST_FILE_PATH }}/rpm/{{ rpm_file_name }}"
      ignore_errors: true
      with_items:
        - "libseccomp-2.3.1-3.el7.x86_64.rpm"
        - "chrony-3.4-1.el7.x86_64.rpm"


 
