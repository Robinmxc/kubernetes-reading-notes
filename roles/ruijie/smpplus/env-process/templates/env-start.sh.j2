#!/bin/sh
current_pid=$$
process_keyword="env-process-task.sh"
pids=$(ps -e -o pid,command | grep "$process_keyword" | awk '{print $1}')
logger  "env-start.sh检测已有进程$pids"
for pid in $pids
do
    if [ $pid -ne $current_pid ]; then
        if ps -p $pid > /dev/null; then
            logger  "env-start.sh杀掉上次进程kill $pid ，当前进程:$current_pid"
            kill -9 $pid
        fi
    fi
done
nohup {{ config_base_dir }}/env-process/env-process-task.sh &